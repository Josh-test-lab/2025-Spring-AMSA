col = rgb(0, 0, 1, 0.5),
border = "blue",
xlim = c(min_x, max_x),
ylim = c(0, max(table(cut(data[, i], breaks_seq))) + 5),
main = "Histogram",
xlab = paste0("X",i),
axes = FALSE)
hist(data_Counterfeit[, i],
breaks = breaks_seq,
col = rgb(1, 0, 0, 0.5),
border = "red",
add = TRUE)
axis(side = 1, at = seq(min_x, max_x, by = 1))
axis(side = 2)
legend("topright",
legend = c("Genuine", "Counterfeit", "Overlap"),
fill = c(rgb(0, 0, 1, 0.5), rgb(1, 0, 0, 0.5), rgb(0.6, 0, 0.4, 0.7)),
border = c("blue", "red", "purple"))
}
data_Genuine = data[1:100, 1:6]
data_Counterfeit = data[101:200, 1:6]
for (i in 1:6) {
breaks_seq = seq(min(data[, i]), max(data[, i]), by = 0.1)
min_x = floor(min(data[, i]))
max_x = ceiling(max(data[, i]))
hist(data_Genuine[, i],
breaks = breaks_seq,
col = "blue",
border = "blue",
xlim = c(min_x, max_x),
ylim = c(0, max(table(cut(data[, i], breaks_seq))) + 5),
main = "Histogram",
xlab = paste0("X",i),
axes = FALSE)
hist(data_Counterfeit[, i],
breaks = breaks_seq,
col = rgb(1, 0, 0, 0.5),
border = "red",
add = TRUE)
axis(side = 1, at = seq(min_x, max_x, by = 1))
axis(side = 2)
legend("topright",
legend = c("Genuine", "Counterfeit", "Overlap"),
fill = c(rgb(0, 0, 1, 0.5), rgb(1, 0, 0, 0.5), rgb(0.6, 0, 0.4, 0.7)),
border = c("blue", "red", "purple"))
}
data_Genuine = data[1:100, 1:6]
data_Counterfeit = data[101:200, 1:6]
for (i in 1:6) {
breaks_seq = seq(min(data[, i]), max(data[, i]), by = 0.1)
min_x = floor(min(data[, i]))
max_x = ceiling(max(data[, i]))
hist(data_Genuine[, i],
breaks = breaks_seq,
col = rgb(0, 0, 1, 0.5),
xlim = c(min_x, max_x),
ylim = c(0, max(table(cut(data[, i], breaks_seq))) + 5),
main = "Histogram",
xlab = paste0("X",i),
axes = FALSE)
hist(data_Counterfeit[, i],
breaks = breaks_seq,
col = rgb(1, 0, 0, 0.5),
border = "red",
add = TRUE)
axis(side = 1, at = seq(min_x, max_x, by = 1))
axis(side = 2)
legend("topright",
legend = c("Genuine", "Counterfeit", "Overlap"),
fill = c(rgb(0, 0, 1, 0.5), rgb(1, 0, 0, 0.5), rgb(0.6, 0, 0.4, 0.7)),
border = c("blue", "red", "purple"))
}
data_Genuine = data[1:100, 1:6]
data_Counterfeit = data[101:200, 1:6]
for (i in 1:6) {
breaks_seq = seq(min(data[, i]), max(data[, i]), by = 0.1)
min_x = floor(min(data[, i]))
max_x = ceiling(max(data[, i]))
hist(data_Genuine[, i],
breaks = breaks_seq,
col = rgb(0, 0, 1, 0.5),
border = "blue",
xlim = c(min_x, max_x),
ylim = c(0, max(table(cut(data[, i], breaks_seq))) + 5),
main = "Histogram",
xlab = paste0("X", i),
axes = FALSE)
hist(data_Counterfeit[, i],
breaks = breaks_seq,
col = rgb(1, 0, 0, 0.5),
border = "red",
add = TRUE)
legend("topright",
legend = c("Genuine", "Counterfeit", "Overlap"),
fill = c(rgb(0, 0, 1, 0.5), rgb(1, 0, 0, 0.5), rgb(0.6, 0, 0.4, 0.7)),
border = c("blue", "red", "purple"))
}
data_Genuine = data[1:100, 1:6]
data_Counterfeit = data[101:200, 1:6]
for (i in 1:6) {
breaks_seq = seq(min(data[, i]), max(data[, i]), by = 0.1)
min_x = floor(min(data[, i]))
max_x = ceiling(max(data[, i]))
hist(data_Genuine[, i],
breaks = breaks_seq,
col = rgb(0, 0, 1, 0.5),
border = "blue",
xlim = c(min_x, max_x),
ylim = c(0, max(table(cut(data[, i], breaks_seq))) + 5),
main = "Histogram",
xlab = paste0("X", i),
axes = FALSE)
hist(data_Counterfeit[, i],
breaks = breaks_seq,
col = rgb(1, 0, 0, 0.5),
border = "red",
add = TRUE)
axis(side = 1, at = seq(min_x, max_x, by = 1))
axis(side = 2)
legend("topright",
legend = c("Genuine", "Counterfeit", "Overlap"),
fill = c(rgb(0, 0, 1, 0.5), rgb(1, 0, 0, 0.5), rgb(0.6, 0, 0.4, 0.7)),
border = c("blue", "red", "purple"))
}
library(ggplot2)
data = read.table('bank2.dat')
colnames(data) = c('X1','X2','X3','X4','X5','X6')
data = data.frame(data, genuine = c(rep(1, 100), rep(0, 100)))
attach(data)
head(data)
print('Quartiles:')
summary(data)
print('NAs:')
sapply(data, function(x) sum(is.na(x)))
library(ggcorrplot)
cor_matrix = cor(data)
ggcorrplot(cor_matrix,
method = "circle",
type = "full",
lab = TRUE,
lab_size = 3,
colors = c("blue", "white", "red"),
outline.color = "gray",
legend.title = "Correlation",
show.legend = TRUE)
pairs(data, upper.panel = NULL)
pairs_plot = function(x, y, x_name, y_name){
par(mar = c(5, 5, 4, 10))
plot(x, y, main = "Swiss bank notes", xlab = x_name, ylab = y_name)
points(x[1:100], y[1:100], col = "blue")
points(x[101:200], y[101:200], col = "red")
legend("topright", legend = c("Genuine", "Counterfeit"), col = c("blue", "red"), pch = 1, xpd = TRUE, inset = c(-0.3, 0))
#ggplot(data.frame(X5, X6), aes(x = X5, y = X6, color = genuine)) +
#geom_point() +
#labs(title = "Swiss bank notes")
}
num = combn(1:6, 2)
for (i in 1:ncol(num)) {
x = paste0("X", num[1, ][i])
y = paste0("X", num[2, ][i])
pairs_plot(get(x), get(y), x, y)
}
name = NULL
for (i in 1:6) {
name = c(name, paste0("X", i, "_Genuine"))
name = c(name, paste0("X", i, "_Counterfeit"))
}
groups = list()
for (i in 1:length(name)){
if (i %% 2 == 1) {
groups[[name[i]]] = data[1:100, as.integer(i / 2) + 1]
} else {
groups[[name[i]]] = data[101:200, as.integer(i / 2)]
}
}
means <- sapply(groups, mean)
par(mfrow=c(1,3))
for (i in seq(1, length(name) ,by = 2)){
boxplot(groups[i:(i + 1)], names = name[i:(i + 1)], frame = TRUE, main = "Swiss bank notes", cex.axis=0.99)
for (j in 0:1) {
lines(c(j + 0.6, j + 1.4), rep(means[[name[(i + j)]]], 2), lty = "dotted", lwd = 1.2)
}
}
regression_model = lm(genuine ~ X1 + X2 + X3 + X4 + X5 + X6)
print(regression_model)
plot(regression_model)
summary(regression_model)
anova(regression_model)
step(regression_model)
logistic_model = glm(genuine ~ X1 + X2 + X3 + X4 + X5 + X6, family = binomial)
print(logistic_model)
plot(logistic_model)
summary(logistic_model)
anova(logistic_model)
step(logistic_model)
data_Genuine = data[1:100, 1:6]
data_Counterfeit = data[101:200, 1:6]
for (i in 1:6) {
breaks_seq = seq(min(data[, i]), max(data[, i]), by = 0.1)
min_x = floor(min(data[, i]))
max_x = ceiling(max(data[, i]))
hist(data_Genuine[, i],
breaks = breaks_seq,
col = rgb(0, 0, 1, 0.5),
border = "blue",
xlim = c(min_x, max_x),
ylim = c(0, max(table(cut(data[, i], breaks_seq))) + 5),
main = "Histogram",
xlab = paste0("X", i),
axes = FALSE)
hist(data_Counterfeit[, i],
breaks = breaks_seq,
col = rgb(1, 0, 0, 0.5),
border = "red",
add = TRUE)
axis(side = 1, at = seq(min_x, max_x, by = 1))
axis(side = 2)
legend("topright",
legend = c("Genuine", "Counterfeit", "Overlap"),
fill = c(rgb(0, 0, 1, 0.5), rgb(1, 0, 0, 0.5), rgb(0.6, 0, 0.4, 0.7)),
border = c("blue", "red", "purple"))
}
data = read.table("bank2.dat")
colnames(data) = c('X1', 'X2', 'X3', 'X4', 'X5', 'X6')
data = data.frame(data, genuine = c(rep(1, 100), rep(0, 100)))
data_Genuine = data[data$genuine == 1, 1:6]
data_Counterfeit = data[data$genuine == 0, 1:6]
overlap_ratios = numeric(ncol(data_Genuine))
par(mfrow = c(1, 1))
num_vars = ncol(data_Genuine)
for (i in 1:num_vars) {
breaks_seq = seq(min(data[, i]), max(data[, i]), by = 0.1)
min_x = floor(min(data[, i]))
max_x = ceiling(max(data[, i]))
hist_Genuine = hist(data_Genuine[, i], breaks = breaks_seq, plot = FALSE)
hist_Counterfeit = hist(data_Counterfeit[, i], breaks = breaks_seq, plot = FALSE)
overlap_counts = pmin(hist_Genuine$counts, hist_Counterfeit$counts)
overlap_ratio = sum(overlap_counts) / sum(hist_Counterfeit$counts)
overlap_ratios[i] = overlap_ratio
plot_title = paste0("Histogram of ", colnames(data)[i],
" (Overlap: ", round(overlap_ratio * 100, 2), "%)")
hist(data_Genuine[, i],
breaks = breaks_seq,
col = rgb(0, 0, 1, 0.5),
border = "blue",
xlim = c(min_x, max_x),
ylim = c(0, max(c(hist_Genuine$counts, hist_Counterfeit$counts)) + 5),
main = plot_title,
xlab = colnames(data)[i],
axes = FALSE)
hist(data_Counterfeit[, i],
breaks = breaks_seq,
col = rgb(1, 0, 0, 0.5),
border = "red",
add = TRUE)
axis(side = 1, at = seq(min_x, max_x, by = 1))
axis(side = 2)
legend("topright",
legend = c("Genuine", "Counterfeit", "Overlap"),
fill = c(rgb(0, 0, 1, 0.5), rgb(1, 0, 0, 0.5), rgb(0.6, 0, 0.4, 0.7)),
border = c("blue", "red", "purple"))
}
library(KernSmooth)
data = read.table("bank2.dat")
par(mfrow = c(1, 1))
for (i in 1:6) {
data_Genuine = data[1:100, i]
data_Counterfeit = data[101:200, i]
fh1 = bkde(data_Genuine, kernel = "biweight")
fh2 = bkde(data_Counterfeit, kernel = "biweight")
x_min = floor(min(c(fh1$x, fh2$x)))
x_max = ceiling(max(c(fh1$x, fh2$x)))
y_max = max(c(fh1$y, fh2$y)) * 1.1
x_ticks <- seq(x_min, x_max, by = 1)
plot(fh1, type = "l", lwd = 2,
xlab = "Counterfeit / Genuine",
ylab = paste0("Density estimates for X", i, sep = ""),
col = "blue", main = paste("Swiss bank notes - X", i),
xlim = c(x_min, x_max), ylim = c(0, y_max),
axes = FALSE)
lines(fh2, lty = "dotted", lwd = 2, col = "red3")
axis(side = 1, at = x_ticks, labels = x_ticks)
axis(side = 2)
box()
legend("topright",
legend = c("Genuine", "Counterfeit"),
col = c("blue", "red3"),
lty = c("solid", "dotted"),
lwd = 2,
cex = 0.8)
}
if (!require(lattice)) install.packages("lattice")
library(lattice)
library(grid)
data = read.table("bank2.dat")
names(data) = paste0("X", 1:6)
group1 = rep(1, 100)
group2 = rep(2, 100)
groups = c(group1, group2)
pch_types = c(1, 1)
colors = c("blue", "red")
pch_group = pch_types[groups]
col_group = colors[groups]
combos = combn(1:6, 3)
n_rows = 1
n_cols = 1
plots_per_page = n_rows * n_cols
for (page in seq(1, ncol(combos), by = plots_per_page)) {
grid.newpage()
for (i in 0:(plots_per_page - 1)) {
index = page + i
if (index > ncol(combos)) break
x_name = paste0("X", combos[1, index])
y_name = paste0("X", combos[2, index])
z_name = paste0("X", combos[3, index])
x_data = data[[x_name]]
y_data = data[[y_name]]
z_data = data[[z_name]]
p = cloud(z_data ~ y_data * x_data,
pch = pch_group,
col = col_group,
cex = 1.2,
ticktype = "detailed",
main = paste("Swiss bank notes:", x_name, y_name, z_name),
screen = list(z = -90, x = -90, y = 45),
scales = list(arrows = FALSE, col = "black", distance = 1, cex = 0.5),
xlab = list(x_name, rot = -10, cex = 1.2),
ylab = list(y_name, rot = 10, cex = 1.2),
zlab = list(z_name, rot = 90, cex = 1.1),
par.settings = list(
axis.line = list(col = "black"),
box.3d = list(
col = c(
"black", "transparent", "transparent","black", "black", "transparent", "transparent", "transparent",
"transparent", "transparent", "transparent", "transparent"))),
key = list(
space = "right",
points = list(pch = pch_types, col = colors, cex = 1.5),
text = list(c("Genuine", "Counterfeit")),
border = FALSE
)
)
print(p, split = c((i %% n_cols) + 1, (i %/% n_cols) + 1, n_cols, n_rows), more = TRUE)
}
}
libraries = c("tourr")
lapply(libraries, function(x) if (!(x %in% installed.packages())) {
install.packages(x)
})
lapply(libraries, library, quietly = TRUE, character.only = TRUE)
# 讀取資料
data = read.table("bank2.dat")
# x：全部 200 筆資料
x = data[1:200, ]
# 初始化 y（做 zero-one scaling）
y = NULL
i = 1
while (i <= 6) {
z = (x[, i] - min(x[, i])) / (max(x[, i]) - min(x[, i]))  # zero-one scaling
y = cbind(y, z)
i = i + 1
}
# 定義類別
Type = c(rep(1, 100), rep(2, 100))  # 前 100 筆為 Type 1，後 100 筆為 Type 2
f = as.integer(Type)
# 定義 t 軸範圍
grid = seq(0, 2 * pi, length = 1000)
# 初始化 plot，畫第一筆曲線
plot(grid,
andrews(y[1, ])(grid),
type = "l",
lwd = 1.2,
main = "Andrews curves (All Bank data)",
axes = FALSE,
frame = TRUE,
ylim = c(-0.5, 0.6),
ylab = "",
xlab = "",
col = ifelse(f[1] == 1, "blue", "red3"),
lty = ifelse(f[1] == 1, "solid", "dotted"))
# 繪製剩餘曲線
for (i in 2:200) {
lines(grid,
andrews(y[i, ])(grid),
col = ifelse(f[i] == 1, "blue", "red3"),
lwd = 1.2,
lty = ifelse(f[i] == 1, "solid", "dotted"))
}
# 增加座標軸
axis(side = 2, at = seq(-0.5, 0.6, 0.2), labels = seq(-0.5, 0.6, 0.2))
axis(side = 1, at = seq(0, 7, 1), labels = seq(0, 7, 1))
# 加上圖例
legend("topright",
legend = c("Genuine", "Counterfeit"),
col = c("blue", "red3"),
lwd = 1.5,
lty = c("solid", "dotted"))
data = read.table("bank2.dat")
colnames(data) = c('X1', 'X2', 'X3', 'X4', 'X5', 'X6')
data = data.frame(data, genuine = c(rep(1, 100), rep(0, 100)))
data_Genuine = data[data$genuine == 1, 1:6]
data_Counterfeit = data[data$genuine == 0, 1:6]
overlap_ratios = numeric(ncol(data_Genuine))
par(mfrow = c(1, 1))
num_vars = ncol(data_Genuine)
for (i in 1:num_vars) {
breaks_seq = seq(min(data[, i]), max(data[, i]), by = 0.1)
min_x = floor(min(data[, i]))
max_x = ceiling(max(data[, i]))
hist_Genuine = hist(data_Genuine[, i], breaks = breaks_seq, plot = FALSE)
hist_Counterfeit = hist(data_Counterfeit[, i], breaks = breaks_seq, plot = FALSE)
overlap_counts = pmin(hist_Genuine$counts, hist_Counterfeit$counts)
overlap_ratio = sum(overlap_counts) / sum(hist_Counterfeit$counts)
overlap_ratios[i] = overlap_ratio
plot_title = paste0("Histogram of ", colnames(data)[i],
" (Overlap: ", round(overlap_ratio * 100, 2), "%)")
hist(data_Genuine[, i],
breaks = breaks_seq,
col = rgb(0, 0, 1, 0.5),
border = "blue",
xlim = c(min_x, max_x),
ylim = c(0, max(c(hist_Genuine$counts, hist_Counterfeit$counts)) + 5),
main = plot_title,
xlab = colnames(data)[i],
axes = FALSE)
hist(data_Counterfeit[, i],
breaks = breaks_seq,
col = rgb(1, 0, 0, 0.5),
border = "red",
add = TRUE)
axis(side = 1, at = seq(min_x, max_x, by = 1))
axis(side = 2)
legend("topright",
legend = c("Genuine", "Counterfeit", "Overlap"),
fill = c(rgb(0, 0, 1, 0.5), rgb(1, 0, 0, 0.5), rgb(0.6, 0, 0.4, 0.7)),
border = c("blue", "red", "purple"))
}
data_Genuine = data[data$genuine == 1, 1:6]
data_Counterfeit = data[data$genuine == 0, 1:6]
overlap_ratios = numeric(ncol(data_Genuine))
par(mfrow = c(1, 1))
num_vars = ncol(data_Genuine)
for (i in 1:num_vars) {
breaks_seq = seq(min(data[, i]), max(data[, i]), by = 0.1)
min_x = floor(min(data[, i]))
max_x = ceiling(max(data[, i]))
hist_Genuine = hist(data_Genuine[, i], breaks = breaks_seq, plot = FALSE)
hist_Counterfeit = hist(data_Counterfeit[, i], breaks = breaks_seq, plot = FALSE)
overlap_counts = pmin(hist_Genuine$counts, hist_Counterfeit$counts)
overlap_ratio = sum(overlap_counts) / sum(hist_Counterfeit$counts)
overlap_ratios[i] = overlap_ratio
plot_title = paste0("Histogram of ", colnames(data)[i],
" (Overlap: ", round(overlap_ratio * 100, 2), "%)")
hist(data_Genuine[, i],
breaks = breaks_seq,
col = rgb(0, 0, 1, 0.5),
border = "blue",
xlim = c(min_x, max_x),
ylim = c(0, max(c(hist_Genuine$counts, hist_Counterfeit$counts)) + 5),
main = plot_title,
xlab = colnames(data)[i],
axes = FALSE)
hist(data_Counterfeit[, i],
breaks = breaks_seq,
col = rgb(1, 0, 0, 0.5),
border = "red",
add = TRUE)
axis(side = 1, at = seq(min_x, max_x, by = 1))
axis(side = 2)
legend("topright",
legend = c("Genuine", "Counterfeit", "Overlap"),
fill = c(rgb(0, 0, 1, 0.5), rgb(1, 0, 0, 0.5), rgb(0.6, 0, 0.4, 0.7)),
border = c("blue", "red", "purple"))
}
numeric(ncol(data_Genuine))
numeric(6)
data_Genuine = data[data$genuine == 1, 1:6]
data_Counterfeit = data[data$genuine == 0, 1:6]
overlap_ratios = numeric(6)
par(mfrow = c(1, 1))
num_vars = ncol(data_Genuine)
for (i in 1:num_vars) {
breaks_seq = seq(min(data[, i]), max(data[, i]), by = 0.1)
min_x = floor(min(data[, i]))
max_x = ceiling(max(data[, i]))
hist_Genuine = hist(data_Genuine[, i], breaks = breaks_seq, plot = FALSE)
hist_Counterfeit = hist(data_Counterfeit[, i], breaks = breaks_seq, plot = FALSE)
overlap_counts = pmin(hist_Genuine$counts, hist_Counterfeit$counts)
overlap_ratio = sum(overlap_counts) / sum(hist_Counterfeit$counts)
overlap_ratios[i] = overlap_ratio
plot_title = paste0("Histogram of ", colnames(data)[i], " (Overlap: ", round(overlap_ratio * 100, 2), "%)")
hist(data_Genuine[, i],
breaks = breaks_seq,
col = rgb(0, 0, 1, 0.5),
border = "blue",
xlim = c(min_x, max_x),
ylim = c(0, max(c(hist_Genuine$counts, hist_Counterfeit$counts)) + 5),
main = plot_title,
xlab = colnames(data)[i],
axes = FALSE)
hist(data_Counterfeit[, i],
breaks = breaks_seq,
col = rgb(1, 0, 0, 0.5),
border = "red",
add = TRUE)
axis(side = 1, at = seq(min_x, max_x, by = 1))
axis(side = 2)
legend("topright",
legend = c("Genuine", "Counterfeit", "Overlap"),
fill = c(rgb(0, 0, 1, 0.5), rgb(1, 0, 0, 0.5), rgb(0.6, 0, 0.4, 0.7)),
border = c("blue", "red", "purple"))
}
