library(ggplot2)
data = read.table('bank2.dat')
colnames(data) = c('X1','X2','X3','X4','X5','X6')
data = data.frame(data, genuine = c(rep(1, 100), rep(0, 100)))
attach(data)
head(data)
print('Quartiles:')
summary(data)
print('NAs:')
sapply(data, function(x) sum(is.na(x)))
pairs(data, upper.panel = NULL)
pairs_plot = function(x, y, x_name, y_name){
par(mar = c(5, 5, 4, 10))
plot(x, y, main = "Swiss bank notes", xlab = x_name, ylab = y_name)
points(x[1:100], y[1:100], col = "blue")
points(x[101:200], y[101:200], col = "red")
legend("topright", legend = c("Genuine", "Counterfeit"), col = c("blue", "red"), pch = 1, xpd = TRUE, inset = c(-0.3, 0))
#ggplot(data.frame(X5, X6), aes(x = X5, y = X6, color = genuine)) +
#geom_point() +
#labs(title = "Swiss bank notes")
}
num = combn(1:6, 2)
for (i in 1:ncol(num)) {
x = paste0("X", num[1, ][i])
y = paste0("X", num[2, ][i])
pairs_plot(get(x), get(y), x, y)
}
name = NULL
for (i in 1:(ncol(data) - 1)) {
name = c(name, paste0("X", i, "_Genuine"))
name = c(name, paste0("X", i, "_Counterfeit"))
}
groups = list()
for (i in 1:length(name)){
if (i %% 2 == 1) {
groups[[name[i]]] = data[1:100, as.integer(i / 2) + 1]
} else {
groups[[name[i]]] = data[101:200, as.integer(i / 2)]
}
}
means <- sapply(groups, mean)
par(mfrow=c(1,3))
for (i in seq(1, length(name) ,by = 2)){
boxplot(groups[i:(i + 1)], names = name[i:(i + 1)], frame = TRUE, main = "Swiss bank notes", cex.axis=0.99)
for (j in 0:1) {
lines(c(j + 0.6, j + 1.4), rep(means[[name[(i + j)]]], 2), lty = "dotted", lwd = 1.2)
}
}
regression_model = lm(genuine ~ X1 + X2 + X3 + X4 + X5 + X6)
print(regression_model)
plot(regression_model)
summary(regression_model)
anova(regression_model)
step(regression_model)
logistic_model = glm(genuine ~ X1 + X2 + X3 + X4 + X5 + X6, family = binomial)
print(logistic_model)
plot(logistic_model)
summary(logistic_model)
anova(logistic_model)
step(logistic_model)
